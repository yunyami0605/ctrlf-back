server:
  port: 9003
  servlet:
    encoding:
      charset: UTF-8
      enabled: true
      force: true

spring:
  jpa:
    hibernate:
      ddl-auto: validate
    properties:
      hibernate.default_schema: infra
      hibernate.format_sql: true
      hibernate.query.escapeCharacter: '\\'
  flyway:
    enabled: true
    schemas: infra
    default-schema: infra
    locations: classpath:db/migration
    validate-on-migrate: false
  profiles:
    active: dev
management:
  endpoints:
    web:
      base-path: /
      exposure:
        include: health
  endpoint:
    health:
      probes:
        enabled: true

# 로깅 설정 (운영 관점)
logging:
  charset:
    console: UTF-8
  file:
    charset: UTF-8
    name: logs/infra-service.log
    max-size: 100MB
    max-history: 30
    total-size-cap: 3GB
  level:
    root: INFO
    com.ctrlf.infra: DEBUG
    org.springframework.web: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

app:
  api:
    title: Infra Service API
    description: 인프라 설정
    security:
      enabled: true
  internal:
    # AI 서버 내부 API 인증 토큰 (AI의 BACKEND_INTERNAL_TOKEN과 동일하게 설정)
    token: ${AI_INTERNAL_TOKEN:dev-internal-token}
  education-service:
    base-url: http://localhost:9002
    timeout-seconds: 10
  s3:
    bucket: ctrl-s3
    ttlSeconds: 36000 # 업로드용 TTL (기본값: 10분)
    downloadTtlSeconds: 43200 # 다운로드용 TTL (6시간)
  elasticsearch:
    uris: ${ELASTICSEARCH_URIS:http://localhost:9200}
    username: ${ELASTICSEARCH_USERNAME:}
    password: ${ELASTICSEARCH_PASSWORD:}
    chat-log-index: chat_log
