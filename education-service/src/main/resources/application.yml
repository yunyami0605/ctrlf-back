server:
  port: 9002
  servlet:
    encoding:
      charset: UTF-8
      enabled: true
      force: true

spring:
  jpa:
    properties:
      hibernate:
        default_schema: education
        format_sql: true
    hibernate:
      ddl-auto: validate
  flyway:
    enabled: true
    schemas: education
    default-schema: education
    locations: classpath:db/migration
    validate-on-migrate: false
    out-of-order: true
    create-schemas: true
  profiles:
    active: dev
management:
  endpoints:
    web:
      base-path: /actuator
      exposure:
        include: health,metrics,prometheus,info
  endpoint:
    health:
      probes:
        enabled: true
      show-details: when-authorized
  metrics:
    export:
      prometheus:
        enabled: true
    tags:
      application: education-service

# 개발 환경 설정
dev:
  auto-source-set-callback: false # true로 설정 시 소스셋 생성 후 자동으로 콜백 시뮬레이션 (AI 서버 호출 없이 처리)

# AI 서버 설정
app:
  ai:
    # AI 서버 내부 API 인증 토큰 (환경변수 AI_INTERNAL_TOKEN 또는 이 값 사용)
    # FastAPI 서버의 BACKEND_INTERNAL_TOKEN과 동일한 값으로 설정해야 합니다.
    token: ${AI_INTERNAL_TOKEN:dev-internal-token}
  video:
    ai:
      # AI 서버 베이스 URL
      base-url: ${AI_BASE_URL:http://localhost:8000}

# Feign 클라이언트 설정
spring.cloud.openfeign:
  client:
    config:
      video-ai-client:
        connect-timeout: 5000
        read-timeout: 30000
        logger-level: BASIC

# 로깅 설정 (운영 관점)
logging:
  charset:
    console: UTF-8
  file:
    charset: UTF-8
    name: logs/education-service.log
    max-size: 100MB
    max-history: 30
    total-size-cap: 3GB
  level:
    root: INFO
    com.ctrlf.education: DEBUG
    com.ctrlf.education.client: DEBUG
    org.springframework.web: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"