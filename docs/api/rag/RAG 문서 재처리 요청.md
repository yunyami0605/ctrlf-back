# ğŸ“˜ **8.5 RAG ë¬¸ì„œ ì¬ì²˜ë¦¬ ìš”ì²­ (í”„ë¡ íŠ¸ì—”ë“œ â†’ ë°±ì—”ë“œ)**

ë¬¸ì„œë¥¼ ìˆ˜ì •í•œ ê²½ìš°,

ìˆ˜ì •ëœ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ **RAG íŒŒì´í”„ë¼ì¸ì„ ì¬ì‹¤í–‰í•˜ê¸° ìœ„í•´ í˜¸ì¶œí•˜ëŠ” API**ì´ë‹¤.

ë¬¸ì„œ ë‚´ìš©(title, domain) ë˜ëŠ” íŒŒì¼(fileUrl)ì´ ë°”ë€Œì—ˆë‹¤ë©´

ë°±ì—”ë“œëŠ” ë‹¤ì‹œ:

- í…ìŠ¤íŠ¸ ì¶”ì¶œ
- ì²­í¬ ë¶„í• 
- ì„ë² ë”© ì¬ìƒì„±

ì„ ìˆ˜í–‰í•˜ë„ë¡ **AI ì„œë²„ì— ì¬ìš”ì²­**í•œë‹¤.

---

## âœ” URL

**POST /rag/documents/{documentId}/reprocess**

---

## âœ” ì„¤ëª…

- í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë¬¸ì„œ ìˆ˜ì • ì´í›„ **â€œì¬ì²˜ë¦¬(Reprocess)â€ ë²„íŠ¼**ì„ í´ë¦­í•˜ë©´ í˜¸ì¶œí•˜ëŠ” API
- ë°±ì—”ë“œëŠ” ë¬¸ì„œ ìƒíƒœë¥¼ `REPROCESSING`ìœ¼ë¡œ ë³€ê²½
- ê·¸ë¦¬ê³  8.4ì— ì •ì˜ëœ ë‚´ë¶€ API(`/ai/rag/process`)ë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•˜ì—¬
  AI ì„œë²„ì—ì„œ ìƒˆ ì„ë² ë”© íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•˜ë„ë¡ í•œë‹¤.
- ì¬ì²˜ë¦¬ ì‘ì—…ì€ ë¹„ë™ê¸° ë°©ì‹ì´ë©° ì¦‰ì‹œ ì™„ë£Œë˜ì§€ ì•ŠëŠ”ë‹¤.

---

## âœ” ê¶Œí•œ

`ROLE_ADMIN`, `ROLE_RAG_MANAGER`

---

# ğŸ“Œ **Request**

ì‚¬ìš©ìê°€ ìˆ˜ì •í•œ ë©”íƒ€ë°ì´í„°ë¥¼ í•¨ê»˜ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.

| key         | ì„¤ëª…                      | íƒ€ì…         | Nullable | ì˜ˆì‹œ                                     |
| ----------- | ------------------------- | ------------ | -------- | ---------------------------------------- |
| title       | ë¬¸ì„œ ì œëª©                 | string       | true     | `"ì‚°ì—…ì•ˆì „ ê·œì •ì§‘ v4"`                   |
| domain      | ë„ë©”ì¸                    | string       | true     | `"HR"`                                   |
| fileUrl     | ìƒˆ ë¬¸ì„œ íŒŒì¼ URL          | string       | true     | `"https://s3.../newfile.pdf"`            |
| requestedBy | ì¬ì²˜ë¦¬ ìš”ì²­í•œ ì‚¬ìš©ì UUID | string(uuid) | false    | `"c13c91f2-fb1a-4d42-b381-72847a52fb99"` |

> â€» ëª¨ë“  í•„ë“œëŠ” optionalì´ì§€ë§Œ
>
> **fileUrl ë˜ëŠ” title/domain ì¤‘ í•˜ë‚˜ ì´ìƒì´ ë³€ê²½ë˜ì–´ì•¼ ì˜ë¯¸ ìˆëŠ” ì¬ì²˜ë¦¬**ê°€ ë¨.

---

### ğŸ“Œ Request Example

```json
{
  "title": "ì‚°ì—…ì•ˆì „ ê·œì •ì§‘ v4",
  "fileUrl": "https://s3.company.com/rag/docs/hr_safety_v4.pdf",
  "requestedBy": "c13c91f2-fb1a-4d42-b381-72847a52fb99"
}
```

---

# ğŸ“Œ **Response**

ë°±ì—”ë“œëŠ” ìš”ì²­ ìˆ˜ì‹  í›„ ì¦‰ì‹œ ACK ì‘ë‹µì„ ë°˜í™˜í•œë‹¤.

ì‹¤ì œ ë¬¸ì„œ ì²˜ë¦¬ ì‘ì—…ì€ ë¹„ë™ê¸° ìˆ˜í–‰.

| key        | ì„¤ëª…                                    | íƒ€ì…             | ì˜ˆì‹œ                    |
| ---------- | --------------------------------------- | ---------------- | ----------------------- |
| documentId | ë¬¸ì„œ ID                                 | number           | 101                     |
| accepted   | ìš”ì²­ì´ ì •ìƒ ì ‘ìˆ˜ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€           | boolean          | true                    |
| status     | ì´ˆê¸° ìƒíƒœ                               | string           | `"REPROCESSING"`        |
| jobId      | ë‚´ë¶€ ì‘ì—… ID (ë°±ì—”ë“œ â†’ AI ì„œë²„ ìš”ì²­ ID) | string           | `"rag-process-88342"`   |
| updatedAt  | ì¬ì²˜ë¦¬ ìš”ì²­ ì‹œê°                        | string(datetime) | `"2025-01-02T13:20:00"` |

---

### ğŸ“Œ Response Example

```json
{
  "documentId": 101,
  "accepted": true,
  "status": "REPROCESSING",
  "jobId": "rag-process-88342",
  "updatedAt": "2025-01-02T13:20:00"
}
```

---

# ğŸ“Œ **Status**

| status                        | ì„¤ëª…                       |
| ----------------------------- | -------------------------- |
| **202 Accepted**              | ì¬ì²˜ë¦¬ ìš”ì²­ ì •ìƒ ìˆ˜ì‹       |
| **400 Bad Request**           | ìˆ˜ì •í•  ê°’ ì—†ìŒ / í˜•ì‹ ì˜¤ë¥˜ |
| **401 Unauthorized**          | ì¸ì¦ ì‹¤íŒ¨                  |
| **403 Forbidden**             | ê¶Œí•œ ë¶€ì¡±                  |
| **404 Not Found**             | ë¬¸ì„œ ì—†ìŒ                  |
| **409 Conflict**              | ì´ë¯¸ ì²˜ë¦¬ ì¤‘ì¸ ë¬¸ì„œ        |
| **500 Internal Server Error** | ë‚´ë¶€ ì˜¤ë¥˜                  |
